# ç¼“å­˜æ•°æ®ä½¿ç”¨è¯´æ˜

## ğŸ¯ æ ¸å¿ƒè¦ç‚¹

**æ‰€æœ‰è®­ç»ƒè„šæœ¬é»˜è®¤ä½¿ç”¨ç¼“å­˜æ•°æ®ï¼Œé€Ÿåº¦å¿«10-100å€ï¼**

---

## âœ… æ­£ç¡®çš„è®­ç»ƒæµç¨‹

### ç¬¬1æ­¥ï¼šæ•°æ®é¢„çƒ­ï¼ˆå¿…é¡»ï¼ï¼‰

```bash
# é¢„çƒ­å…¨å¸‚åœºæ•°æ®åˆ°ç¼“å­˜
python scripts/prepare_training_data.py --symbols all --workers 8 --resume
```

**è¾“å‡ºï¼š**
- Kçº¿ç¼“å­˜ï¼š`data/parquet/*.parquet`
- ç‰¹å¾ç¼“å­˜ï¼š`data/features/*_features.parquet`

### ç¬¬2æ­¥ï¼šè®­ç»ƒæ¨¡å‹ï¼ˆè‡ªåŠ¨ä½¿ç”¨ç¼“å­˜ï¼‰

```bash
# é€šç”¨æ¨¡å‹è®­ç»ƒï¼ˆè‡ªåŠ¨ä½¿ç”¨ç¼“å­˜ï¼‰
python scripts/train_universal_model.py

# ç‹¬ç«‹æ¨¡å‹è®­ç»ƒï¼ˆè‡ªåŠ¨ä½¿ç”¨ç¼“å­˜ï¼‰
python scripts/batch_train_all_stocks.py
```

**âœ… æ— éœ€é¢å¤–å‚æ•°ï¼** è„šæœ¬ä¼šè‡ªåŠ¨ä» `data/parquet` å’Œ `data/features` åŠ è½½ç¼“å­˜æ•°æ®ã€‚

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### æ•°æ®åŠ è½½é€Ÿåº¦

| æ•°æ®æº | 5000åªè‚¡ç¥¨ | è¯´æ˜ |
|--------|-----------|------|
| **ç¼“å­˜æ•°æ®** | **2-5åˆ†é’Ÿ** | âœ… æ¨è |
| MySQLæ•°æ®åº“ | 2-3å°æ—¶ | âŒ éå¸¸æ…¢ |

**æå‡ï¼š** 30-100å€ï¼

### å®Œæ•´è®­ç»ƒæ—¶é—´

| æ¨¡å‹ç±»å‹ | ä½¿ç”¨ç¼“å­˜ | ä¸ä½¿ç”¨ç¼“å­˜ | æå‡ |
|---------|---------|-----------|------|
| é€šç”¨æ¨¡å‹ | 2-5å°æ—¶ | 5-8å°æ—¶ | 2x |
| ç‹¬ç«‹æ¨¡å‹ | 40-50å°æ—¶ | 80-120å°æ—¶ | 2x |

---

## ğŸ”§ æ•°æ®æºæ§åˆ¶

### é»˜è®¤è¡Œä¸ºï¼ˆæ¨èï¼‰

```bash
# è‡ªåŠ¨ä½¿ç”¨ç¼“å­˜æ•°æ®
python scripts/train_universal_model.py
```

**æ•°æ®æºï¼š**
- Kçº¿ç¼“å­˜ï¼š`data/parquet/`
- ç‰¹å¾ç¼“å­˜ï¼š`data/features/`

### å¼ºåˆ¶ä½¿ç”¨æ•°æ®åº“ï¼ˆä¸æ¨èï¼‰

```bash
# ä»MySQLæ•°æ®åº“åŠ è½½ï¼ˆéå¸¸æ…¢ï¼ï¼‰
python scripts/train_universal_model.py --no-cache
```

**âš ï¸ è­¦å‘Šï¼š** ä¼šæ…¢10-100å€ï¼Œä»…ç”¨äºè°ƒè¯•ï¼

### è‡ªå®šä¹‰ç¼“å­˜ç›®å½•

```bash
# ä½¿ç”¨è‡ªå®šä¹‰ç¼“å­˜ç›®å½•
python scripts/train_universal_model.py \
    --kline-cache-dir /data/cache/kline \
    --feature-cache-dir /data/cache/features
```

---

## ğŸ” å¦‚ä½•ç¡®è®¤ä½¿ç”¨äº†ç¼“å­˜ï¼Ÿ

### æ–¹æ³•1ï¼šæŸ¥çœ‹è¾“å‡ºæ—¥å¿—

```bash
python scripts/train_universal_model.py
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
é…ç½®:
  æ¨¡å‹ç±»å‹: lstm
  ...
  æ•°æ®æº: ç¼“å­˜æ•°æ®          â† ç¡®è®¤ä½¿ç”¨ç¼“å­˜
    Kçº¿ç¼“å­˜: data/parquet
    ç‰¹å¾ç¼“å­˜: data/features

ä½¿ç”¨ç¼“å­˜æ•°æ®åŠ è½½ 5000 åªè‚¡ç¥¨...  â† ç¡®è®¤ä½¿ç”¨ç¼“å­˜
  Kçº¿ç¼“å­˜: data/parquet
  ç‰¹å¾ç¼“å­˜: data/features

[100/5000] å·²åŠ è½½ 98 åª (ç¼“å­˜å‘½ä¸­: 95, æœªå‘½ä¸­: 3)  â† ç¼“å­˜å‘½ä¸­ç‡
```

### æ–¹æ³•2ï¼šè§‚å¯ŸåŠ è½½é€Ÿåº¦

| ç°è±¡ | æ•°æ®æº |
|------|--------|
| 5000åªè‚¡ç¥¨åŠ è½½2-5åˆ†é’Ÿ | âœ… ç¼“å­˜æ•°æ® |
| 5000åªè‚¡ç¥¨åŠ è½½2-3å°æ—¶ | âŒ MySQLæ•°æ®åº“ |

### æ–¹æ³•3ï¼šæ£€æŸ¥ç¼“å­˜æ–‡ä»¶

```bash
# æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨
ls data/parquet/*.parquet | wc -l
ls data/features/*_features.parquet | wc -l

# åº”è¯¥çœ‹åˆ°å¤§é‡æ–‡ä»¶
# ä¾‹å¦‚ï¼š5000åªè‚¡ç¥¨ = 5000ä¸ªKçº¿æ–‡ä»¶ + 5000ä¸ªç‰¹å¾æ–‡ä»¶
```

---

## âŒ å¸¸è§é”™è¯¯

### é”™è¯¯1ï¼šæ²¡æœ‰é¢„çƒ­æ•°æ®

**ç—‡çŠ¶ï¼š**
```
ä½¿ç”¨ç¼“å­˜æ•°æ®åŠ è½½ 5000 åªè‚¡ç¥¨...
[100/5000] å·²åŠ è½½ 2 åª (ç¼“å­˜å‘½ä¸­: 0, æœªå‘½ä¸­: 100)
```

**åŸå› ï¼š** ç¼“å­˜ç›®å½•ä¸ºç©ºï¼Œè„šæœ¬å›é€€åˆ°MySQLæ•°æ®åº“

**è§£å†³ï¼š**
```bash
# å…ˆé¢„çƒ­æ•°æ®
python scripts/prepare_training_data.py --symbols all --workers 8 --resume
```

### é”™è¯¯2ï¼šç¼“å­˜ç›®å½•ä¸å­˜åœ¨

**ç—‡çŠ¶ï¼š**
```
FileNotFoundError: [Errno 2] No such file or directory: 'data/parquet'
```

**è§£å†³ï¼š**
```bash
# åˆ›å»ºç›®å½•å¹¶é¢„çƒ­æ•°æ®
mkdir -p data/parquet data/features
python scripts/prepare_training_data.py --symbols all --workers 8 --resume
```

### é”™è¯¯3ï¼šè¯¯ç”¨ --no-cache

**ç—‡çŠ¶ï¼š** è®­ç»ƒéå¸¸æ…¢ï¼Œæ•°æ®åŠ è½½éœ€è¦2-3å°æ—¶

**åŸå› ï¼š** ä½¿ç”¨äº† `--no-cache` å‚æ•°

**è§£å†³ï¼š**
```bash
# ç§»é™¤ --no-cache å‚æ•°
python scripts/train_universal_model.py  # ä¸è¦åŠ  --no-cache
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. å®šæœŸæ›´æ–°ç¼“å­˜

```bash
# æ¯å‘¨æ›´æ–°ä¸€æ¬¡ç¼“å­˜æ•°æ®
python scripts/prepare_training_data.py \
    --symbols all \
    --workers 8 \
    --resume \
    --start-date $(date -d '2 years ago' +%Y-%m-%d)
```

### 2. æ£€æŸ¥ç¼“å­˜çŠ¶æ€

```bash
# æ£€æŸ¥ç¼“å­˜æ–‡ä»¶æ•°é‡
echo "Kçº¿ç¼“å­˜: $(ls data/parquet/*.parquet 2>/dev/null | wc -l) ä¸ªæ–‡ä»¶"
echo "ç‰¹å¾ç¼“å­˜: $(ls data/features/*_features.parquet 2>/dev/null | wc -l) ä¸ªæ–‡ä»¶"

# æ£€æŸ¥ç¼“å­˜å¤§å°
du -sh data/parquet data/features
```

### 3. æ¸…ç†æ—§ç¼“å­˜

```bash
# æ¸…ç†è¶…è¿‡30å¤©çš„ç¼“å­˜
find data/parquet -name "*.parquet" -mtime +30 -delete
find data/features -name "*_features.parquet" -mtime +30 -delete

# é‡æ–°é¢„çƒ­
python scripts/prepare_training_data.py --symbols all --workers 8 --resume
```

---

## ğŸ“ æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. âœ… **é»˜è®¤ä½¿ç”¨ç¼“å­˜** - æ‰€æœ‰è®­ç»ƒè„šæœ¬é»˜è®¤ä½¿ç”¨ç¼“å­˜æ•°æ®
2. âœ… **å¿…é¡»é¢„çƒ­** - è®­ç»ƒå‰å¿…é¡»å…ˆæ‰§è¡Œæ•°æ®é¢„çƒ­
3. âœ… **é€Ÿåº¦å¿«** - ç¼“å­˜æ•°æ®åŠ è½½é€Ÿåº¦å¿«10-100å€
4. âœ… **æ— éœ€å‚æ•°** - é»˜è®¤é…ç½®å³å¯ï¼Œæ— éœ€é¢å¤–å‚æ•°

### å¿«é€Ÿå¼€å§‹

```bash
# 1. é¢„çƒ­æ•°æ®ï¼ˆå¿…é¡»ï¼ï¼‰
python scripts/prepare_training_data.py --symbols all --workers 8 --resume

# 2. è®­ç»ƒæ¨¡å‹ï¼ˆè‡ªåŠ¨ä½¿ç”¨ç¼“å­˜ï¼‰
python scripts/train_universal_model.py
```

### ç¡®è®¤ä½¿ç”¨ç¼“å­˜

æŸ¥çœ‹è¾“å‡ºæ—¥å¿—ä¸­çš„ï¼š
- `æ•°æ®æº: ç¼“å­˜æ•°æ®`
- `ä½¿ç”¨ç¼“å­˜æ•°æ®åŠ è½½ X åªè‚¡ç¥¨...`
- `ç¼“å­˜å‘½ä¸­: X åª`

ç°åœ¨ä½ çŸ¥é“å¦‚ä½•æ­£ç¡®ä½¿ç”¨ç¼“å­˜æ•°æ®äº†ï¼ğŸš€
